/*
 * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one
 * or more contributor license agreements. Licensed under the Elastic License
 * 2.0; you may not use this file except in compliance with the Elastic License
 * 2.0.
 */
import React from 'react';
import { EuiFlexGroup, EuiFlexItem, EuiHealth } from '@elastic/eui';
import { useCnvmStatisticsApi } from '../../common/api/use_vulnerabilities_stats_api';
import { useNavigateVulnerabilities } from '../../common/hooks/use_navigate_vulnerablities';
import { CompactFormattedNumber } from '../../components/compact_formatted_number';
import { getSeverityStatusColor } from '../../common/utils/get_vulnerability_colors';
import { CspCounterCard } from '../../components/csp_counter_card';

export const VulnerabilityStatistics = () => {
  const navToVulnerabilities = useNavigateVulnerabilities();
  const getCnvmStats = useCnvmStatisticsApi();

  const stats = [
    {
      id: '1',
      title: <CompactFormattedNumber number={getCnvmStats.data?.cnvmStatistics.cloudRegions} />,
      description: 'Cloud Region',
    },
    {
      id: '2',
      title: <CompactFormattedNumber number={getCnvmStats.data?.cnvmStatistics.resourcesScanned} />,
      description: 'Assets Scanned',
    },
    {
      id: '3',
      title: <CompactFormattedNumber number={getCnvmStats.data?.cnvmStatistics.criticalCount} />,
      description: <EuiHealth color={getSeverityStatusColor('CRITICAL')}>Critical</EuiHealth>,
      onClick: () => {
        navToVulnerabilities({ 'vulnerability.severity': 'CRITICAL' });
      },
    },
    {
      id: '4',
      title: <CompactFormattedNumber number={getCnvmStats.data?.cnvmStatistics.highCount} />,
      description: <EuiHealth color={getSeverityStatusColor('HIGH')}>High</EuiHealth>,
      onClick: () => {
        navToVulnerabilities({ 'vulnerability.severity': 'HIGH' });
      },
    },
    {
      id: '5',
      title: <CompactFormattedNumber number={getCnvmStats.data?.cnvmStatistics.mediumCount} />,
      description: <EuiHealth color={getSeverityStatusColor('MEDIUM')}>Medium</EuiHealth>,
      onClick: () => {
        navToVulnerabilities({ 'vulnerability.severity': 'MEDIUM' });
      },
    },
  ];

  return (
    <EuiFlexGroup>
      {stats.map((stat) => (
        <EuiFlexItem>
          <CspCounterCard {...stat} />
        </EuiFlexItem>
      ))}
    </EuiFlexGroup>
  );
};
